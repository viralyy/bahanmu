<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Player Level Dewa</title>

<style>
:root{
  --bg:#0b0f1a;
  --panel:#12172a;
  --text:#eaf0ff;
  --muted:#9aa4c7;
  --accent:#4f8cff;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:linear-gradient(180deg,#050714,#0b0f1a);
  color:var(--text);
  font-family:system-ui,Inter,Arial;
}
.wrapper{
  max-width:1000px;
  margin:20px auto;
  padding:12px;
}
.card{
  background:var(--panel);
  border-radius:16px;
  box-shadow:0 20px 40px rgba(0,0,0,.6);
  overflow:hidden;
}
.video-wrap{
  position:relative;
  background:#000;
}
video{
  width:100%;
  max-height:70vh;
  display:block;
  background:#000;
}
.play-overlay{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
}
.play-btn{
  background:rgba(0,0,0,.65);
  border:1px solid rgba(255,255,255,.15);
  border-radius:999px;
  padding:14px 22px;
  display:flex;
  align-items:center;
  gap:10px;
  cursor:pointer;
  backdrop-filter:blur(6px);
}
.play-btn svg{width:22px;height:22px;fill:#fff}

.controls{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px;
  border-top:1px solid rgba(255,255,255,.05);
}
.btn{
  background:rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.08);
  color:var(--text);
  padding:8px 12px;
  border-radius:10px;
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:6px;
}
.btn svg{width:16px;height:16px;fill:currentColor}

.seek{
  flex:1;
}
.seek input{
  width:100%;
}

.meta{
  padding:14px;
}
.title{
  font-size:20px;
  font-weight:800;
}
.stats{
  display:flex;
  gap:14px;
  margin-top:10px;
  flex-wrap:wrap;
}
.stat{
  background:rgba(255,255,255,.04);
  padding:8px 12px;
  border-radius:10px;
  font-size:13px;
  color:var(--muted);
}
.stat b{color:#fff}

@media(max-width:600px){
  .controls{flex-wrap:wrap}
}
</style>
</head>

<body>
<div class="wrapper">
  <div class="card">

    <div class="video-wrap">
      <video id="video" preload="metadata" playsinline></video>
      <div class="play-overlay" id="overlay">
        <div class="play-btn" id="playBtn">
          <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
          PLAY
        </div>
      </div>
    </div>

    <div class="controls">
      <button class="btn" id="toggle">
        <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
        Play
      </button>
      <div class="seek">
        <input type="range" id="seek" min="0" max="100" value="0">
      </div>
      <button class="btn" id="mute">
        <svg viewBox="0 0 24 24"><path d="M5 9v6h4l5 5V4l-5 5z"/></svg>
      </button>
    </div>

    <div class="meta">
      <div class="title">Exclusive Stream</div>
      <div class="stats">
        <div class="stat">üëÅ Total views: <b id="views">0</b></div>
        <div class="stat">üìÖ Hari ini: <b id="today">0</b></div>
        <div class="stat">üü¢ Online: <b id="online">0</b></div>
      </div>
    </div>

  </div>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getDatabase, ref, runTransaction, onValue, set, onDisconnect } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBK67RIVjmaZDPk-ctYfc87oAukamqFNMQ",
  authDomain: "stream-counter-b13fc.firebaseapp.com",
  databaseURL: "https://stream-counter-b13fc-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "stream-counter-b13fc",
  storageBucket: "stream-counter-b13fc.firebasestorage.app",
  messagingSenderId: "280528312474",
  appId: "1:280528312474:web:24d9e47c62ef523d9f2723"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// ID unik per halaman
const PAGE_ID = "player-demo-1";

// ===== VIEW COUNTER =====
const viewsRef = ref(db, `pages/${PAGE_ID}/views`);
const todayRef = ref(db, `pages/${PAGE_ID}/today/${new Date().toISOString().slice(0,10)}`);

// anti spam
if(!localStorage.getItem("viewed-"+PAGE_ID)){
  runTransaction(viewsRef, v => (v || 0) + 1);
  runTransaction(todayRef, v => (v || 0) + 1);
  localStorage.setItem("viewed-"+PAGE_ID,"1");
}

// realtime update
onValue(viewsRef, s => views.textContent = s.val() || 0);
onValue(todayRef, s => today.textContent = s.val() || 0);

// ===== ONLINE COUNTER =====
const onlineRef = ref(db, `pages/${PAGE_ID}/online/${crypto.randomUUID()}`);
set(onlineRef, true);
onDisconnect(onlineRef).remove();

onValue(ref(db, `pages/${PAGE_ID}/online`), snap=>{
  online.textContent = snap.size || 0;
});
</script>

<!-- PLAYER SCRIPT -->
<script>
const video = document.getElementById("video");
video.src = "https://cdn.videy.co/QbnJRJmV1.mp4";

const overlay = document.getElementById("overlay");
const toggle = document.getElementById("toggle");
const seek = document.getElementById("seek");
const mute = document.getElementById("mute");

function playToggle(){
  if(video.paused){
    video.play();
    overlay.style.display="none";
  }else{
    video.pause();
  }
}

toggle.onclick = playToggle;
overlay.onclick = playToggle;
video.onclick = playToggle;

video.ontimeupdate = ()=>{
  seek.value = (video.currentTime / video.duration) * 100 || 0;
}
seek.oninput = ()=>{
  video.currentTime = (seek.value/100) * video.duration;
}
mute.onclick = ()=>{
  video.muted = !video.muted;
}
</script>

</body>
</html>
