<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Panel (Auto ID)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  background:#0b0b0b;
  color:#f1f1f1;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif
}
.page{
  max-width:520px;
  margin:auto;
  padding:16px
}
h2{margin:8px 0}
input,textarea{
  width:100%;
  padding:10px;
  margin-top:6px;
  background:#111;
  border:1px solid #222;
  border-radius:10px;
  color:#fff
}
textarea{min-height:120px}
button{
  width:100%;
  padding:12px;
  margin-top:12px;
  border:none;
  border-radius:14px;
  background:linear-gradient(135deg,#ff0055,#ff3c7d);
  color:#fff;
  font-weight:600;
  cursor:pointer
}
.download-row{
  display:flex;
  gap:6px;
  margin-top:6px
}
.download-row input{
  flex:1
}
.small{
  font-size:12px;
  color:#aaa;
  margin-top:4px
}
</style>
</head>

<body>

<div class="page">
  <h2>Admin Panel (Auto ID)</h2>

  <label>Judul Video</label>
  <input id="titleInput" placeholder="Judul video">

  <label>Link Stream</label>
  <input id="stream" placeholder="https://cdn...mp4">

  <label>Download</label>
  <div id="downloads">
    <div class="download-row">
      <input placeholder="Label (misal: Full Terabox)">
      <input placeholder="Link download">
    </div>
  </div>

  <button onclick="addDownload()">+ Tambah Download</button>

  <button onclick="generate()">Generate JSON</button>

  <label>Hasil JSON</label>
  <textarea id="json" readonly></textarea>

  <label>Link Stream</label>
  <input id="link" readonly>

  <p class="small">
    ⚡ ID dibuat otomatis (random) <br>
    ⚡ Tinggal copas JSON ke <b>videos.json</b>
  </p>
</div>

<script>
function autoID(){
  return "vid_" + Date.now() + "_" + Math.random().toString(36).substr(2,4);
}

function addDownload(){
  const box = document.getElementById("downloads");
  const row = document.createElement("div");
  row.className = "download-row";
  row.innerHTML = `
    <input placeholder="Label">
    <input placeholder="Link download">
  `;
  box.appendChild(row);
}

function generate(){
  const id = autoID();
  const title = document.getElementById("titleInput").value.trim();
  const src = document.getElementById("stream").value.trim();

  if(!title || !src){
    alert("Judul & stream wajib diisi!");
    return;
  }

  const downloads = [];
  document.querySelectorAll(".download-row").forEach(r=>{
    const label = r.children[0].value.trim();
    const url = r.children[1].value.trim();
    if(url){
      downloads.push({
        label: label || "Download",
        url
      });
    }
  });

  if(!downloads.length){
    downloads.push({ label:"Download", url:src });
  }

  const json = {
    [id]: {
      title,
      src,
      downloads
    }
  };

  const jsonText = JSON.stringify(json, null, 2);
  document.getElementById("json").value = jsonText;

  document.getElementById("link").value =
    location.origin +
    location.pathname.replace("admin1.html","player.html") +
    "?v=" + id;

  navigator.clipboard.writeText(jsonText).catch(()=>{});
}
</script>

</body>
</html>
